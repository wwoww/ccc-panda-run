window.__require=function e(t,i,o){function s(r,a){if(!i[r]){if(!t[r]){var c=r.split("/");if(c=c[c.length-1],!t[c]){var h="function"==typeof __require&&__require;if(!a&&h)return h(c,!0);if(n)return n(c,!0);throw new Error("Cannot find module '"+r+"'")}}var d=i[r]={exports:{}};t[r][0].call(d.exports,function(e){return s(t[r][1][e]||e)},d,d.exports,e,t,i,o)}return i[r].exports}for(var n="function"==typeof __require&&__require,r=0;r<o.length;r++)s(o[r]);return s}({background:[function(e,t,i){"use strict";cc._RF.push(t,"ad41c/xVbdPkbW3QvzF211v","background"),cc.Class({extends:cc.Component,properties:{near_bg:[cc.Node],far_bg:[cc.Node],near_speed:5,far_speed:.5},onLoad:function(){this.fixBgPos(this.far_bg[0],this.far_bg[1]),this.fixBgPos(this.near_bg[0],this.near_bg[1])},fixBgPos:function(e,t){e.x=0;var i=e.getBoundingBox();t.setPosition(i.xMax,i.yMin)},update:function(e){this.bgMove(this.far_bg,this.far_speed),this.bgMove(this.near_bg,this.near_speed),this.checkBgReset(this.far_bg),this.checkBgReset(this.near_bg)},bgMove:function(e,t){for(var i=0;i<e.length;i++){e[i].x-=t}},checkBgReset:function(e){cc.winSize;if(e[0].getBoundingBox().xMax<=0){var t=e.shift();e.push(t);var i=e[0];t.x=i.getBoundingBox().xMax}}}),cc._RF.pop()},{}],"game-scene":[function(e,t,i){"use strict";cc._RF.push(t,"facf018is5ERKFkFWa/fWq7","game-scene"),cc.Class({extends:cc.Component,properties:{platform_generator:null,platform_default_0:cc.Node,platform_default_1:cc.Node},onLoad:function(){var e=cc.find("platform-generator");this.platform_generator=e.getComponent("platform-generator"),this.platform_generator.initPlatforms([this.platform_default_0,this.platform_default_1])}}),cc._RF.pop()},{}],"panda-control":[function(e,t,i){"use strict";cc._RF.push(t,"d5100S4m6ROAJ4FE6j+WaBp","panda-control"),cc.Class({extends:cc.Component,properties:{speed:cc.v2(0,0),addSpeed:600,maxSpeed:cc.v2(10,1e3),gravity:-1e3,jumpSpeed:300,collisionX:0,collisionY:0,direction:0,jumping:!1,jumpCount:0,drag:1e3,prePosition:cc.v2(0,0),player:null,uiLayer:cc.Node,uiLayerComonent:null},onLoad:function(){this.prePosition.x=this.node.x,this.prePosition.y=this.node.y,cc.director.getCollisionManager().enabled=!0,this.player=this.node.getComponent(cc.Animation),this.uiLayerComonent=this.uiLayer.getComponent("uiLayer"),cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyPressed:this.onKeyPressed.bind(this),onKeyReleased:this.onKeyReleased.bind(this)},this.node)},onDestroy:function(){cc.director.getCollisionManager().enabled=!1,cc.director.getCollisionManager().enabledDebugDraw=!1},onKeyPressed:function(e,t){switch(e){case cc.KEY.d:this.direction=1,this.jumping||this.player.play("run");break;case cc.KEY.a:this.direction=-1,this.jumping||this.player.play("run");break;case cc.KEY.j:(!this.jumping||this.jumpCount<2)&&(this.jumping=!0,this.speed.y=this.jumpSpeed,this.jumpCount++,this.jumpCount<2?this.player.play("jump"):this.player.play("twiceJump"))}},onKeyReleased:function(e,t){switch(e){case cc.KEY.d:1==this.direction&&(this.direction=0);break;case cc.KEY.a:-1==this.direction&&(this.direction=0)}},collisionGoldEnter:function(e,t){e.node.removeFromParent(),this.uiLayerComonent.addGold()},collisionPlatformEnter:function(e,t){var i=t.world.aabb.clone(),o=e.world.aabb,s=t.world.preAabb;if(i.x=s.x,i.y=s.y,i.x=t.world.aabb.x,cc.Intersection.rectRect(i,o))return this.speed.x<0&&i.xMax>o.xMax?(this.node.x=o.xMax,this.collisionX=-1):this.speed.x>0&&i.xMin<o.xMin&&(this.node.x=o.xMin-i.width,this.collisionX=1),void(this.speed.x=0);i.y=t.world.aabb.y,cc.Intersection.rectRect(i,o)&&(this.speed.y<0&&i.yMax>o.yMax?(this.node.y=o.yMax,this.jumping=!1,this.player.play("run"),this.jumpCount=0,this.collisionY=-1):this.speed.y>0&&i.yMin<o.yMin&&(this.node.y=o.yMin-i.height,this.collisionY=1),this.speed.y=0)},onCollisionEnter:function(e,t){console.log("on collision enter"),cc.log("coll tag = "+e.tag),1==e.tag?this.collisionGoldEnter(e,t):this.collisionPlatformEnter(e,t)},onCollisionStay:function(e,t){if(0==e.tag&&-1===this.collisionY){var i=cc.v2(e.world.aabb.x-e.world.preAabb.x,0);this.node.x+=i.x}},onCollisionExit:function(e,t){console.log("on collision exit"),0==e.tag&&(this.collisionX=0,this.collisionY=0,this.jumping=!0,this.jumpCount=1,this.player.play("jump"))},update:function(e){if(0===this.collisionY&&(this.speed.y+=this.gravity*e,Math.abs(this.speed.y)>this.maxSpeed.y&&(this.speed.y=this.speed.y>0?this.maxSpeed.y:-this.maxSpeed.y)),0===this.direction)this.speed.x>0?(this.speed.x-=this.drag*e,this.speed.x<=0&&(this.speed.x=0)):this.speed.x<0&&(this.speed.x+=this.drag*e,this.speed.x>=0&&(this.speed.x=0));else{var t=this.speed.x>0?1:-1;0==this.speed.x&&(t=0);var i=t==this.direction?this.addSpeed:3e3;this.speed.x+=(this.direction>0?1:-1)*i*e,Math.abs(this.speed.x)>this.maxSpeed.x&&(this.speed.x=this.speed.x>0?this.maxSpeed.x:-this.maxSpeed.x)}this.speed.x*this.collisionX>0&&(this.speed.x=0),this.prePosition.x=this.node.x,this.prePosition.y=this.node.y,this.node.x+=this.speed.x*e,this.node.y+=this.speed.y*e}}),cc._RF.pop()},{}],"platform-generator":[function(e,t,i){"use strict";cc._RF.push(t,"a5b85M16A9GbZoyKP97bDi4","platform-generator"),cc.Class({extends:cc.Component,properties:{platform_list:[],move_speed:.1,platform_prafab:[cc.Prefab],platform_layer:cc.Node,gold_group_list:[cc.Prefab],maxMoveSpeed:8},initPlatforms:function(e){this.platform_list=e,e.forEach(function(e){e.setAnchorPoint(0,0)},this)},generate:function(e){var t=4*Math.random();t=Math.floor(t);var i=cc.instantiate(this.platform_prafab[t]);i.setAnchorPoint(0,0);var o=this.platform_layer.getContentSize();i.x=o.width,i.y=Math.random()*(o.height-100),cc.log(i.y);i.y>e.y+100&&(i.y=e.y+100),this.platform_list.push(i),this.platform_layer.addChild(i);var s=3*Math.random();s=Math.floor(s);var n=cc.instantiate(this.gold_group_list[s]),r=i.getContentSize();n.setPosition(r.width/2,r.height),i.addChild(n),cc.log("\u4ea7\u51fa\u4e00\u4e2a\u5e73\u53f0,\u5e73\u53f0\u6570=",this.platform_list.length)},update:function(e){for(var t,i=[],o=0;o<this.platform_list.length;o++)(t=this.platform_list[o]).x-=this.move_speed,t.getBoundingBox().xMax>0?i.push(t):t.removeFromParent();if(this.platform_list=i,t){var s=cc.winSize,n=t.getBoundingBox();n.x+n.width<.8*s.width&&this.generate(t),this.move_speed<this.maxMoveSpeed&&(this.move_speed+=.001)}}}),cc._RF.pop()},{}],uiLayer:[function(e,t,i){"use strict";cc._RF.push(t,"68c90r5ql1P0ppR4qeTEULM","uiLayer"),cc.Class({extends:cc.Component,properties:{gold_label:cc.Label,goldNum:0},onLoad:function(){},addGold:function(){this.goldNum++,this.gold_label.string=this.goldNum+""}}),cc._RF.pop()},{}]},{},["background","uiLayer","panda-control","platform-generator","game-scene"]);